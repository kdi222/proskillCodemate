{"version":3,"file":"reviewfilter.min.js","sources":["../src/reviewfilter.js"],"sourcesContent":["/* eslint-disable no-alert */\n/* eslint-disable no-console */\n/* eslint-disable no-unused-vars */\ndefine(['jquery', 'core/ajax', 'core/notification', 'core/str', 'core/templates'], function ($, Ajax, Notification, Str) {\n\n    var SELECTORS = {\n        REVIEWDATA: '.reviewdata',\n        SHOWMOREREVIEWBTN: '.showmorereviewsbtn',\n        COURSEID: '#courseId',\n        REVIEWSELECTOR: '.reviewselector',\n        SHOWMOREREVIEWCLASS: '#showmorereviewclass',\n    };\n\n\n    // ****** IMPORTANT ******\n    // Do not change the sequence.\n    // If you want to add new strings here, add it at the bottom.\n    // Do not remove any string from the array.\n    // There is no way we can revert back if sequence is changed.\n    // ****** IMPORTANT ******\n    const strings = [\n        {key: 'noreviewsfound', component: 'block_edwiserratingreview'},\n        {key: 'showmorereview', component: 'block_edwiserratingreview'},\n        {key: 'showmorereviwebutton', component: 'block_edwiserratingreview'},\n    ];\n\n    var LANGS; // Gloabl variable to store languages.\n\n    // Functionality to fetch strings.\n    const fetchLanguages = () => {\n        Str.get_strings(strings).then(function(results) {\n            LANGS = results;\n            return results;\n        });\n    };\n\n    var getreviewdata = function (rates) {\n        Ajax.call([{\n            methodname: 'block_edwiserratingreview_show_review',\n            args: { rating: rates, startlimit: 0, lastlimit: 5, contextid: M.cfg.courseContextId },\n            done: function (data) {\n                var result ='<div class=\"m-3\">' + M.util.get_string('noreviewsfound', 'block_edwiserratingreview')+'</div>';\n                if (data !== '') {\n                    result = data;\n                }\n\n                $(SELECTORS.REVIEWDATA).empty().append(result);\n\n                if ($(SELECTORS.REVIEWDATA).children('li.review-card').length == 5) {\n                    var showmorereviewbuttontext = M.util.get_string('showmorereview', 'block_edwiserratingreview');\n                    // eslint-disable-next-line max-len\n                    var showmorereviebtn = M.util.get_string('showmorereviwebutton', 'block_edwiserratingreview');\n                    $(SELECTORS.SHOWMOREREVIEWCLASS).empty().append(showmorereviebtn);\n                    setbuttonurl(rates);\n                } else {\n                    $(SELECTORS.SHOWMOREREVIEWCLASS).empty().append('');\n                }\n            },\n            fail: function () {\n                console.log(Notification.exception);\n            }\n        }]);\n\n    };\n\n    var setbuttonurl = function (rating) {\n        var url = M.cfg.wwwroot + '/blocks/edwiserratingreview/view.php?filter=' + rating + '&contextid=' + M.cfg.courseContextId;\n        $(SELECTORS.SHOWMOREREVIEWBTN).attr('href', url);\n    };\n\n    const loadReviews = () => {\n        var rating = $('.reviewselector option:selected').attr('value');\n        getreviewdata(rating);\n    };\n\n    return {\n        init: function () {\n            $(document).ready(function () {\n                fetchLanguages();\n\n                loadReviews();\n\n                $(document).on(\"change\", SELECTORS.REVIEWSELECTOR, function () {\n                    loadReviews();\n                });\n            });\n        }\n    };\n\n});\n"],"names":["define","$","Ajax","Notification","Str","SELECTORS","strings","key","component","setbuttonurl","rating","url","M","cfg","wwwroot","courseContextId","attr","loadReviews","rates","call","methodname","args","startlimit","lastlimit","contextid","done","data","result","util","get_string","empty","append","children","length","showmorereviebtn","fail","console","log","exception","init","document","ready","get_strings","then","results","on"],"mappings":"AAGAA,gDAAO,CAAC,SAAU,YAAa,oBAAqB,WAAY,mBAAmB,SAAUC,EAAGC,KAAMC,aAAcC,SAE5GC,qBACY,cADZA,4BAEmB,sBAFnBA,yBAIgB,kBAJhBA,8BAKqB,6BAUnBC,QAAU,CACZ,CAACC,IAAK,iBAAkBC,UAAW,6BACnC,CAACD,IAAK,iBAAkBC,UAAW,6BACnC,CAACD,IAAK,uBAAwBC,UAAW,kCA0CzCC,aAAe,SAAUC,YACrBC,IAAMC,EAAEC,IAAIC,QAAU,+CAAiDJ,OAAS,cAAgBE,EAAEC,IAAIE,gBAC1Gd,EAAEI,6BAA6BW,KAAK,OAAQL,YAG1CM,YAAc,SAlCUC,MAmCtBR,OAAST,EAAE,mCAAmCe,KAAK,SAnC7BE,MAoCZR,OAnCdR,KAAKiB,KAAK,CAAC,CACPC,WAAY,wCACZC,KAAM,CAAEX,OAAQQ,MAAOI,WAAY,EAAGC,UAAW,EAAGC,UAAWZ,EAAEC,IAAIE,iBACrEU,KAAM,SAAUC,UACRC,OAAQ,oBAAsBf,EAAEgB,KAAKC,WAAW,iBAAkB,6BAA6B,YACtF,KAATH,OACAC,OAASD,MAGbzB,EAAEI,sBAAsByB,QAAQC,OAAOJ,QAE0B,GAA7D1B,EAAEI,sBAAsB2B,SAAS,kBAAkBC,OAAa,CACjCrB,EAAEgB,KAAKC,WAAW,iBAAkB,iCAE/DK,iBAAmBtB,EAAEgB,KAAKC,WAAW,uBAAwB,6BACjE5B,EAAEI,+BAA+ByB,QAAQC,OAAOG,kBAChDzB,aAAaS,YAEbjB,EAAEI,+BAA+ByB,QAAQC,OAAO,KAGxDI,KAAM,WACFC,QAAQC,IAAIlC,aAAamC,sBAgB9B,CACHC,KAAM,WACFtC,EAAEuC,UAAUC,OAAM,WA/CtBrC,IAAIsC,YAAYpC,SAASqC,MAAK,SAASC,gBAC3BA,QACDA,WAgDH3B,cAEAhB,EAAEuC,UAAUK,GAAG,SAAUxC,0BAA0B,WAC/CY"}
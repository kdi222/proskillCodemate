define(["jquery","core/url"],function(a,b){function c(a,c,d){return void 0===d&&(d="edit"),b.relativeUrl("/mod/vpl/forms")+"/"+d+".json.php?id="+a+"&userId="+c+"&action="}var d={},e={reqfile:[],execfiles:[]};return d.info=function(b,d){return void 0!=e[b][d]?a.Deferred().resolve(e[b][d]).promise():("reqfile"==b?VPLUtil.requestAction("resetfiles","",{},c(d,"")):VPLUtil.requestAction("load","",{},c(d,"","executionfiles"))).then(function(a){var c="reqfile"==b?a.files[0]:a.files;return e[b][d]=c,c}).promise()},d.save=function(c,d,e,f){return a.ajax(b.relativeUrl("/question/type/vplquestion/ajax/savetovpl.json.php"),{data:{id:c,qid:d,answer:e,filestype:f},method:"POST"}).promise()},d.exec=function(a,b,d,e,f){var g={ajaxurl:c(b,d),resultSet:!1,setResult:function(a){this.resultSet=!0,f(a)},close:function(){var a=this;setTimeout(function(){a.resultSet||f({execerror:M.util.get_string("execerrordetails","qtype_vplquestion")})},600)},getConsole:function(){return e},run:function(a,b,c){var d=this;e.connect(b.executionURL,function(){c.close(),d.resultSet||f({})})}};return VPLUtil.requestAction(a,"",{},g.ajaxurl).done(function(a){VPLUtil.webSocketMonitor(a,"","",g)}).promise()},{call:function(a,...b){return VPLUtil.progressBar=function(){this.setLabel=function(){},this.close=function(){},this.isClosed=function(){return!0}},d[a](...b)},langOfFile:function(a){return VPLUtil.langType(a.split(".").pop())},isBinary:function(a){return VPLUtil.isBinary(a)}}});
//# sourceMappingURL=vplservice.min.js.map